@{
    ViewData["Title"] = "Home Page";
}

<!-- breadcrumb -->
<div class="breadcrumb-header justify-content-between">
	<div class="left-content">
		<span class="main-content-title mg-b-0 mg-b-lg-1">DASHBOARD</span>
	</div>
	<div class="justify-content-center mt-2">
		<ol class="breadcrumb">
			<li class="breadcrumb-item tx-15"><a href="javascript:void(0);">Dashboard</a></li>
			<li class="breadcrumb-item active" aria-current="page">Dashboard</li>
		</ol>
	</div>
</div>
<!-- /breadcrumb -->
<!-- row -->
<div class="row">
	<div class="col-xxl-5 col-xl-12 col-lg-12 col-md-12 col-sm-12">
		<div class="row">
			<div class="col-xl-12 col-lg-12 col-md-12 col-xs-12">
				<div class="card">
					<div class="card-body">
						<div class="row">
							<div class="col-xl-9 col-lg-7 col-md-6 col-sm-12">
								<div class="text-justified align-items-center">
									<h3 class="text-dark font-weight-semibold mb-2 mt-0">Hi, Welcome To <span class="text-primary">Rupali Credit Co-operative Ltd. Accounts!</span></h3>
									<p class="text-dark tx-14 mb-3 lh-3"> You have used the 85% of free plan storage. Please upgrade your plan to get unlimited storage.</p>
									<button class="btn btn-primary shadow">Upgrade Now</button>
								</div>
							</div>
							<div class="col-xl-3 col-lg-5 col-md-6 col-sm-12 d-flex align-items-center justify-content-center upgrade-chart-circle">
								<div class="chart-circle float-md-end mt-4 mt-md-0" data-value="0.75" data-thickness="8" data-color="">
									<canvas width="100" height="100"></canvas>
									<div class="chart-circle-value circle-style"><div class="tx-18 font-weight-semibold">85%</div></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>




			
		</div>
	</div>
</div>


<!-- row closed -->
@section Scripts {

	<script src="~/assets/plugins/jquery/jquery.min.js"></script>
	<script src="~/assets/plugins/raphael/raphael.min.js"></script>
	<script src="~/assets/plugins/select2/js/select2.full.min.js"></script>
	<script src="~/assets/js/select2.js"></script>

	<script src="~/assets/plugins/morris.js/morris.min.js"></script>
	<script src="~/assets/commonjs/dashboard.js"></script>
	
	<script src="~/assets/plugins/moment/moment.js"></script>
	<script src="~/assets/js/apexcharts.js"></script>
   
	<script src="~/assets/js/index.js"></script>
	<script src="~/assets/js/themecolor.js"></script>
	<script>
		

		$(document).ready(function () {
			$('.select2').select2

			var year = $('#year').val();
			statistics1(year);

			$.ajax({
				url: '@Url.Action("GetDountChartData", "Home")',
				type: 'GET',
				dataType: 'json',
				success: function (data) {
					// Create Morris Donut Chart
					new Morris.Donut({
						element: 'morrisDonut1',
						data: data,
						colors: ['#4CAF50', '#FFC107'],
					});
				},
				error: function () {
					console.log(data);
					alert('Error retrieving data.');
				}
			});

			$('#year').change(function () {

				var year = $('#year').val();
				console.log(year);
				statistics1(year);
			});

		function statistics1(year) {
				
				setTimeout(() => {
					// Make an AJAX request to fetch data from the controller method
					$.ajax({
						url: '/Home/GetYearlyCPFDepositChartData',
						type: 'GET',
						dataType: 'json',
						data: {
						year: year // Pass the parameter here
						},
						success: function (data) {
							console.log("Jewel ");
							console.log(data);
							var cpfData = data.map(item => item.cpf);
							var rcclData = data.map(item => item.rccl);

							var options1 = {
								series: [{
									name: 'Total Deposit',
									data: cpfData,
								}, {
									name: 'Total Contribution',
									data: rcclData,
								}],
								chart: {
									type: 'bar',
									height: 280
								},
								grid: {
									borderColor: '#f2f6f7',
								},
								colors: [myVarVal || "#38cab3", "#33cc33"],
								plotOptions: {
									bar: {
										colors: {
											ranges: [{
												from: -100,
												to: -46,
												color: '#ebeff5'
											}, {
												from: -45,
												to: 0,
												color: '#ebeff5'
											}]
										},
										columnWidth: '40%',
									}
								},
								dataLabels: {
									enabled: false,
								},
								stroke: {
									show: true,
									width: 4,
									colors: ['transparent']
								},
								legend: {
									show: true,
									position: 'top',
								},
								yaxis: {
									title: {
										text: 'CPF ' + year,
										style: {
											color: '#ff0066',
											fontSize: '14px',
											fontFamily: 'poppins, sans-serif',
											fontWeight: 600,
											cssClass: 'apexcharts-yaxis-label',
										},
									},
									labels: {
										formatter: function (y) {
											return y.toFixed(0) + "";
										}
									}
								},
								xaxis: {
									type: 'month',
									categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
									axisBorder: {
										show: true,
										color: 'rgba(119, 119, 142, 0.05)',
										offsetX: 0,
										offsetY: 0,
									},
									axisTicks: {
										show: true,
										borderType: 'solid',
										color: 'rgba(119, 119, 142, 0.05)',
										width: 6,
										offsetX: 0,
										offsetY: 0
									},
									labels: {
										rotate: -90
									}
								}
							};

							// Rest of your chart rendering logic
							document.getElementById('statistics1').innerHTML = '';
							var chart1 = new ApexCharts(document.querySelector("#statistics1"), options1);
							chart1.render();
						},
						error: function (error) {
							console.error('Error fetching data from the server', error);
						}
					});
				}, 300);
			}
		});


	</script>
}
